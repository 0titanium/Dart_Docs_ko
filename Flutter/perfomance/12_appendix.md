# 성능에 대한 추가적인 생각 More thoughts about performance

성능이란 무엇인가?

성능은 수행자의 정량화 가능한 속성 집합입니다.

이 맥락에서 성능은 행동 자체의 실행이 아니라, 어떤 것이거나 누군가가 얼마나 잘 수행하는지를 의미합니다. 따라서 우리는 '퍼포먼트(pourformant)'라는 형용사를 사용합니다.

일반적으로 '얼마나 잘'이라는 부분은 자연어로 설명할 수 있지만, 우리의 한정된 범위에서는 실제 숫자로 정량화할 수 있는 것에 초점을 맞추고 있습니다. 실제 숫자에는 정수와 0/1 이진수 같은 특별한 경우가 포함됩니다. 자연어로 된 설명도 여전히 매우 중요합니다. 예를 들어, 숫자(정량적 값) 없이 단어만으로 Flutter의 성능을 강하게 비판하는 뉴스 기사는 여전히 의미가 있을 수 있으며, 큰 영향을 미칠 수 있습니다. 이 한정된 범위는 단지 우리의 한정된 자원 때문입니다.

성능을 설명하는 데 필요한 양은 종종 '메트릭(metric)'이라고 불립니다.

무수한 성능 문제와 메트릭을 탐색하기 위해, 수행자를 기준으로 분류할 수 있습니다.

예를 들어, 이 웹사이트의 대부분 콘텐츠는 Flutter 앱의 성능에 관한 것으로, 여기서 수행자는 Flutter 앱입니다. 인프라 성능도 Flutter에서 중요하며, 여기서 수행자는 빌드 봇과 CI 작업 실행기입니다. 이들은 Flutter가 코드 변경을 통합하여 앱 성능을 개선하는 속도에 큰 영향을 미칩니다.

여기서 범위를 의도적으로 넓혀 앱 성능 문제뿐만 아니라 다른 성능 문제를 포함시킨 이유는, 수행자가 누구인지와 관계없이 많은 도구를 공유할 수 있기 때문입니다. 예를 들어, Flutter 앱 성능과 인프라 성능은 동일한 대시보드와 유사한 알림 메커니즘을 공유할 수 있습니다.

범위를 넓히는 것은 전통적으로 무시하기 쉬운 수행자를 포함할 수 있게 해줍니다. 문서 성능이 그 예입니다. 수행자는 SDK의 API 문서일 수 있으며, 메트릭은 API 문서를 유용하다고 생각하는 독자의 비율이 될 수 있습니다.

## 왜 성능이 중요한가? Why is performance important?

이 질문에 답하는 것은 성능 작업의 가치를 검증하는 데뿐만 아니라, 성능 작업을 더 유용하게 안내하는 데에도 중요합니다. "왜 성능이 중요한가?"라는 질문에 대한 답변은 종종 "성능은 어떻게 유용한가?"에 대한 답이기도 합니다.

간단히 말해, 성능은 정량화 가능한 속성이나 메트릭을 가져야 하기 때문에 중요하고 유용합니다. 이는 다음을 의미합니다:

1. 성능 보고서는 소비하기 쉽다.
2. 성능은 모호성이 적다.
3. 성능은 비교 가능하고 전환 가능하다.
4. 성능은 공정하다.

비성능 문제나 비측정 가능한 문제 또는 설명이 중요하지 않다는 것은 아닙니다. 이들은 성능이 더 유용할 수 있는 상황을 강조하기 위해 존재합니다.

## 1. 성능 보고서는 소비하기 쉽다

성능 메트릭은 숫자입니다. 숫자를 읽는 것은 긴 텍스트를 읽는 것보다 훨씬 쉽습니다. 예를 들어, 엔지니어가 1에서 5까지의 성능 평가를 숫자로 소비하는 데는 약 1초가 걸릴 것입니다. 반면, 같은 엔지니어가 500단어의 피드백 요약을 모두 읽는 데는 최소 1분은 걸릴 것입니다.

숫자가 많을 경우, 이를 요약하거나 시각화하여 빠르게 소비할 수 있습니다. 예를 들어, 히스토그램, 평균, 분위수 등을 통해 수백만 개의 숫자를 빠르게 파악할 수 있습니다. 메트릭이 수천 개의 데이터 포인트를 가진 이력이 있다면, 이를 기반으로 트렌드를 읽기 위해 타임라인을 쉽게 그릴 수 있습니다.

반면, 500단어의 텍스트가 n개 있다면, 해당 텍스트를 소비하는 데 n배의 시간이 소요되는 것은 거의 보장됩니다. 500단어씩 있는 수천 개의 역사적 설명을 분석하는 것은 힘든 작업이 될 것입니다.

## 2. 성능은 모호성이 적다

성능을 숫자 집합으로 표현하는 또 다른 장점은 명확성이 높다는 것입니다. 애니메이션의 성능을 프레임당 20ms 또는 50fps로 설정하고 싶을 때, 숫자에 대한 해석의 여지가 거의 없습니다. 반면, 같은 애니메이션을 설명할 때, 어떤 사람은 '좋다'고 표현할 수 있지만, 다른 사람은 '나쁘다'고 불평할 수 있습니다. 유사하게, 같은 단어 또는 구절이 서로 다른 사람에 의해 다르게 해석될 수 있습니다. 예를 들어, 어떤 사람은 괜찮은 프레임 속도를 60fps로 해석할 수 있지만, 다른 사람은 30fps로 해석할 수 있습니다.

숫자가 항상 정확한 것은 아닙니다. 예를 들어, 프레임당 측정된 시간은 해당 프레임의 실제 계산 시간에 CPU/GPU가 무관한 작업에 소요한 랜덤한 시간(잡음)을 더한 것일 수 있습니다. 따라서 메트릭이 변동할 수 있습니다. 그럼에도 불구하고 숫자가 의미하는 바에 대한 모호성은 없습니다. 또한, 이러한 잡음을 처리하기 위한 엄격한 이론과 테스트 도구가 존재합니다. 예를 들어, 여러 번 측정하여 확률 변수의 분포를 추정하거나, 많은 측정값의 평균을 내어 대수의 법칙을 이용해 잡음을 제거할 수 있습니다.

## 3. 성능은 비교 가능하고 변환 가능하다

성능 수치는 모호한 의미를 가질 뿐만 아니라, 명확한 비교도 가능합니다. 예를 들어, 5가 4보다 크다는 것은 의심의 여지가 없습니다. 반면, '우수한(excellent)'이 '매우 우수한(superb)'보다 더 나은지 판단하는 것은 주관적일 수 있습니다. 마찬가지로, '서사적(epic)'이 '전설적(legendary)'보다 더 나은지 판단할 수 있을까요? 실제로 '기대 이상으로 강하게 초과'라는 표현은 누군가의 해석에 따라 '매우 우수한(superb)'보다 더 나을 수도 있습니다. 이 정의가 '기대 이상으로 강하게 초과'를 4로, '매우 우수한'을 5로 매핑해야만 비교가 명확해집니다.

숫자는 공식을 사용하여 쉽게 변환할 수 있습니다. 예를 들어, 60fps는 프레임당 16.67ms로 변환할 수 있습니다. 프레임의 렌더링 시간 x(ms)는 이진 지표로 변환할 수 있습니다: `isSmooth = [x <= 16] = (x <= 16 ? 1 : 0)`와 같은 방식으로요. 이러한 변환은 중첩되거나 연결될 수 있어, 단일 측정을 사용하여 추가적인 잡음이나 모호성 없이 다양한 양을 얻을 수 있습니다. 변환된 양은 추가적인 비교 및 소비를 위해 사용될 수 있습니다. 자연어를 다룰 때는 이러한 변환이 거의 불가능합니다.

## 4. 성능은 공정하다

문제를 발견하기 위해 장황한 설명에 의존해야 한다면, 더 장황한 사람들(대화나 글쓰기를 더 많이 하는 사람들)이나 개발 팀과 가까운 사람들(대면 회의나 대화 비용이 적고 커뮤니케이션의 폭이 넓은 사람들)에게 불공정한 이점이 주어집니다.

사용자와의 거리가 멀거나 침묵을 지키고 있는 사용자와 관계없이 동일한 메트릭을 사용하여 문제를 탐지함으로써, 모든 문제를 공정하게 다룰 수 있습니다. 이는 궁극적으로 더 큰 영향을 미치는 올바른 문제에 집중할 수 있게 해줍니다.

## 성능을 유용하게 만드는 방법

다음은 여기에서 논의된 4가지 포인트를 약간 다른 관점에서 요약한 것입니다:

1. 성능 메트릭을 쉽게 소비할 수 있도록 만드세요. 독자에게 많은 숫자(또는 단어)로 압도하지 마세요. 숫자가 많다면, 이를 더 작은 숫자 집합으로 요약하려고 노력하세요(예: 여러 숫자를 하나의 평균 숫자로 요약). 숫자가 크게 변화할 때만 독자에게 알리세요(예: 급증이나 회귀에 대한 자동 경고).

2. 성능 메트릭을 가능한 한 명확하게 만드세요. 숫자가 사용하는 단위를 정의하세요. 숫자가 어떻게 측정되는지 정확하게 설명하세요. 숫자가 쉽게 재현 가능하도록 만드세요. 잡음이 많은 경우, 전체 분포를 보여주거나 많은 잡음 있는 측정을 집계하여 잡음을 최대한 제거하려고 하세요.

3. 성능을 쉽게 비교할 수 있도록 하세요. 예를 들어, 현재 버전과 이전 버전을 비교할 수 있는 타임라인을 제공하세요. 한 메트릭을 다른 메트릭으로 변환할 수 있는 방법과 도구를 제공하세요. 예를 들어, 메모리 증가와 fps 저하를 사용자가 감소한 수나 손실된 수익으로 변환할 수 있다면, 이를 비교하고 정보에 기반한 타협을 할 수 있습니다.

4. 성능 메트릭이 가능한 넓은 인구를 모니터링하도록 하세요, 그러면 누구도 소외되지 않습니다.